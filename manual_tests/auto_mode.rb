require_relative 'api'

LED.delete('') # kill current mode
LED.post('', {mode: 'manual'})
LED.post('brightness', value: 1) # turn off all LEDs

LED.delete('') # kill current mode
LED.post('', {mode: 'auto'})

indices = (0...(COUNT)).map do |i|
  list = (i...([i+30, COUNT-1].min)).to_a
  list += (0..(29 - list.count)).to_a
  list
end[0..-2]

xs = [[7], [8], [6], [9], [10], [5], [12], [11], [13], [14], [15], [16], [17], [18], [0], [19], [20], [21], [134, 184], [183], [22], [125], [133], [67], [76, 77], [75], [124, 182, 232], [293], [66], [132], [74], [231], [123, 181], [292], [65], [131], [73], [230], [122, 180], [71], [72, 130, 291], [188], [25], [81], [229], [64, 179], [121], [290], [26], [238], [82, 228], [178], [63, 120, 237], [289], [239], [27], [83], [227], [177, 240], [62], [119, 288], [226], [241], [176], [143, 193], [287], [118], [61], [192], [242], [29], [85], [225], [175], [286], [60, 117], [243], [30], [144], [224], [174], [285], [116, 194], [244], [59], [145], [31], [223], [245], [284], [173], [195], [115], [58], [146], [32], [246], [222], [283], [172], [114], [57], [247], [221], [148, 171, 282], [198], [147, 197], [113], [248], [33, 56], [34], [220], [90, 281], [249], [170], [149], [112], [55], [35], [89, 219], [250], [280], [169, 199], [150], [111], [54], [251], [218], [279], [200], [168], [151], [252], [110], [37, 53], [217], [201, 278], [167], [253], [109], [52], [216], [277], [254], [166], [153], [108], [51, 215], [203, 255], [276], [154, 165], [107, 256], [204], [50, 214], [275], [155], [164], [106, 257], [205], [213], [49], [274], [156], [98, 206], [258], [163], [105], [97, 212], [48], [273], [259], [162], [104], [260], [47, 211, 272], [158, 208], [161, 261], [103], [159], [271], [210], [160], [46], [45], [299]]

ys = [[162], [163], [164], [161], [165], [19], [20, 166], [21], [160, 167], [18], [168], [22, 169], [158], [159], [25], [170], [26], [17], [171], [27], [172], [156], [173], [29], [155], [174], [16], [30, 154], [175], [153], [31, 176], [32], [177], [15], [148], [151, 178], [34, 147], [89], [179], [35], [150], [90], [180], [14, 149], [37, 181], [182], [33], [13], [183], [146], [145], [184], [12], [144], [46], [45, 47], [48, 49], [143], [50], [51, 52], [53], [188], [54, 56], [11, 57, 58, 59, 60, 61, 62], [55], [63], [64], [65], [66], [67], [10], [237], [71], [192], [72], [9], [193], [73], [194], [74, 134], [8], [133], [195], [132], [7, 75], [131], [197], [76, 130], [6], [198], [5], [199], [200], [201], [77], [125], [0], [203], [81, 124], [123, 204], [82], [122], [205], [83], [121], [120], [119], [85, 118], [208], [117], [206], [116], [210], [115], [211], [114], [212], [113], [213], [112], [214], [215], [111], [216], [109, 110], [217], [108], [218], [107], [219], [106], [220], [97], [105], [221], [104], [222], [103], [98], [223], [224], [225], [226], [227], [228], [229], [230], [231], [232], [238], [239], [240], [241], [242], [243], [244], [245], [246], [247], [248, 299], [249], [250], [251], [252], [253], [254], [255], [256], [257], [258], [259], [260], [261], [271], [272], [273], [274], [275], [276], [277], [278, 280, 281, 282], [279, 283], [284, 285], [286], [287, 288], [289], [290], [291], [292, 293]]

xs2 = xs.reduce([]) do |a,e|
  a + [(e + a.flatten).uniq]
end


ys2 = ys.reduce([]) do |a,e|
  a + [(e + a.flatten).uniq]
end

pp xs2

LED.post('program', sequence: xs2 + ys2, step_time: 10)
